<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Candlestick Pattern Recognition</title>
    <script src="https://code.highcharts.com/stock/highstock.js"></script>
    <script src="https://code.highcharts.com/stock/modules/exporting.js"></script>
</head>
<body>
    <div id="container" style="height: 500px; min-width: 310px"></div>

    <script>
        // Sample static data for testing (you can replace this with live data)
        const forexData = [
            [1634236800000, 1.158, 1.159, 1.156, 1.157], // [timestamp, open, high, low, close]
            [1634238600000, 1.157, 1.160, 1.155, 1.159],
            [1634240400000, 1.159, 1.162, 1.158, 1.160],
            [1634242200000, 1.160, 1.165, 1.158, 1.164],
            [1634244000000, 1.164, 1.166, 1.160, 1.161],
            [1634245800000, 1.161, 1.163, 1.159, 1.160], // Example Bearish Engulfing
            [1634247600000, 1.160, 1.164, 1.158, 1.163], // Example Bullish Engulfing
            [1634249400000, 1.163, 1.166, 1.161, 1.162],
            [1634251200000, 1.162, 1.165, 1.160, 1.164],
            [1634253000000, 1.164, 1.168, 1.162, 1.167]
        ];

        // Function to detect basic candlestick patterns
        function detectPatterns(data) {
            const patterns = [];

            for (let i = 1; i < data.length; i++) {
                const [prevTime, prevOpen, prevHigh, prevLow, prevClose] = data[i - 1];
                const [time, open, high, low, close] = data[i];

                // Bullish Engulfing Pattern
                if (prevOpen > prevClose && open < close && open < prevClose && close > prevOpen) {
                    patterns.push({ time, type: 'Bullish Engulfing', signal: 'Bullish reversal' });
                }

                // Bearish Engulfing Pattern
                if (prevOpen < prevClose && open > close && open > prevClose && close < prevOpen) {
                    patterns.push({ time, type: 'Bearish Engulfing', signal: 'Bearish reversal' });
                }
            }

            return patterns;
        }

        // Detect patterns
        const patterns = detectPatterns(forexData);

        // Create the chart with detected patterns
        Highcharts.stockChart('container', {
            rangeSelector: {
                selected: 1
            },

            title: {
                text: 'Forex Live Chart with Candlestick Pattern Detection'
            },

            series: [{
                type: 'candlestick',
                name: 'EUR/USD',
                data: forexData,
                tooltip: {
                    valueDecimals: 4
                }
            }],

            // Highlight detected patterns with plot bands
            xAxis: {
                plotBands: patterns.map(pattern => ({
                    from: pattern.time - (30 * 60 * 1000), // Show band around the time
                    to: pattern.time + (30 * 60 * 1000),
                    color: pattern.type.includes('Bullish') ? 'rgba(0, 255, 0, 0.2)' : 'rgba(255, 0, 0, 0.2)',
                    label: {
                        text: pattern.type,
                        style: {
                            color: '#606060'
                        }
                    }
                }))
            }
        });
    </script>
</body>
</html>
